<!DOCTYPE html>
<html ng-app="musicApp">

  <head>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert-dev.js"></script>

    <!-- sweetalert to customize alert box -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,100,900' rel='stylesheet' type='text/css'>
    <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>

    <!-- to remove # from url -->
    <base href="/"></base>

  </head>

  <body ng-controller="YouTubeController">

    <header>

    <span ng-controller="AboutController">
      <!--       playlistLogo -->
      <img src="logo.png" id="logo-image" ng-click="toggleAbout()" >

        <about-directive show='showAbout' width='750px' height='62%'>

          <div id="results">

            <div class="photo" ng-cloak>
              <a href="https://github.com/wired4code" target="_blank" class="link">
                <img class="photo-thumb" src="sonny.png" width="112" height="90">
                <span class="video-title">
                  Sonny Sheth
                </span>
                <span class="video-author">
                  Product Owner
                </span>
                <span class="video-description">
                  https://github.com/wired4code
                </span>
              </a>
            </div>


            <div class="photo" ng-cloak>
              <a href="https://github.com/invisiblebeard" target="_blank" class="link">
                <img class="photo-thumb" src="calvin.png" width="112" height="90">
                <span class="video-title">
                  Calvin Le
                </span>
                <span class="video-author">
                  Scrum Master
                </span>
                <span class="video-description">
                  https://github.com/invisiblebeard
                </span>
              </a>
            </div>

            <div class="photo" ng-cloak>
              <a href="https://github.com/abc810221" target="_blank" class="link">
                <img class="video-thumb" src="ted.png" width="112" height="90">
                <span class="video-title">
                  Ted Hsiao
                </span>
                <span class="video-author">
                  Full-Stack Developer
                </span>
                <span class="video-description">
                  https://github.com/abc810221
                </span>
              </a>
            </div>

            <div class="photo" ng-cloak>
              <a href="https://github.com/tcoughlin3" target="_blank" class="link">
                <img class="video-thumb" src="tom.png" width="112" height="90">
                <span class="video-title">
                  Tom Coughlin
                </span>
                <span class="video-author">
                  Full-Stack Developer
                </span>
                <span class="video-description">
                  https://github.com/tcoughlin3
                </span>
              </a>
            </div>

            <div class="techtitle">Tech Stack</div>

            <div ng-cloak>
              <img class="tech-thumb" src="angularjs.png" width="112" height="90">
              <img class="tech-thumb" src="express.png" width="112" height="90">
              <img class="tech-thumb" src="jquery.jpg" width="112" height="90">
              <img class="tech-thumb" src="node.png" width="112" height="90">
              <img class="tech-thumb" style="padding-left:15px; padding-right:25px" src="socketio.png" width="142" height="55">
              <img class="tech-thumb" src="sweetalert.png" width="112" height="90">
              <img class="tech-thumb" src="youtube.png" width="120" height="90">
            </div>

          </div>

        </about-directive>
    </span>


    <!-- YouTube search box -->
    <form id="search" ng-submit="getSearch(); toggleResults()" ng-controller="SearchController">

      <input id="search-input" ng-model="field" type="text" placeholder="Search for and add YouTube videos to the playlist" autocomplete="off">

      <input id="search-submit" type="image" src="search.png">
      <!-- Angular directive to load search results modal on submit -->
      <search-directive show='showResults' width='750px' height='62%'>

        <div id="results">

          <div class="video" ng-cloak ng-repeat="result in searchList track by $index" ng-click="enqueue(result)">

            <img class="video-thumb" src={{result.snippet.thumbnails.default.url}}>

            <span class="video-title">
              {{result.snippet.title| limitTo: 75 }}{{result.snippet.description.length > 75 ? '...' : ''}}
            </span>

            <span class="video-author">
              {{result.snippet.channelTitle}}
            </span>

            <span class="video-description">
              {{result.snippet.description | limitTo: 160 }}{{result.snippet.description.length > 160 ? '...' : ''}}
            </span>

          </div>

        </div>

      </search-directive>

      </form>
      <!-- Controls to skip and sync current video being played -->
      <h1 id="skip" ng-click="skip()">skip</h1>
      <h1 id="sync" ng-click="sync()">sync</h1>
      <!-- Volume control slider -->
      <input id="volume" min ="0" max="100" step="1" type="range" ng-model="volume" value="50"></input>

    </header>
      <!-- container holds video screen, playlist queue and chat -->
      <!-- <div class="container"> -->
      <!-- this div contains the video screen and playlist queue -->
      <div id="player-queue">
        <!-- YouTube API adds the video player in the player div -->
        <div id="player"></div>
        <!-- to display the current video being played -->
        <div id="current-song">

            <span id="default-playlist-message" ng-cloak ng-show="!current.title">
              Playlist is currently empty
            </span>
            <!-- we set a limit on title character length -->
            <span ng-cloak ng-show="current.title">
              {{ current.title | limitTo: 58 }}{{current.title.length > 60 ? '...' : ''}}
            </span>
            <span id="duration" ng-cloak ng-show="current.title">
              {{time}}
            </span>

        </div>
        <!-- to display our up and down arrows and vote counter -->
        <div class="votes" ng-show="current.title">

          <p id="added-by" ng-cloak ng-show="current.title">
            â€” added by {{ current.username }}
          </p>

          <p id="arrows">
            <!-- up green arrow -->
            <img src="upvote.svg" onmouseover="this.src='uphover.svg';" onmouseout="this.src='upvote.svg';" class="up-arrow" ng-click="upCount()"></img>

            <span class="vote-count" ng-cloak>
              {{upcount}}
            </span>
            <!-- down red arrow -->
            <img src="downvote.svg" onmouseover="this.src='downhover.svg';" onmouseout="this.src='downvote.svg';" class="down-arrow" ng-click="downCount()"></img>

            <span class="vote-count" ng-cloak>
              {{downcount}}
            </span>

          </p>
        </div>
        <!-- to display videos in playlist -->
        <div id="queue">

          <div class="pending-songs" ng-cloak ng-repeat="song in list track by $index">

            <p id="queue-title" ng-cloak>
              {{ song.title | limitTo: 74 }}{{song.title.length > 74 ? '...' : ''}}
            </p>
            <!-- to remove a video from playlist -->
            <p id="queue-remove" ng-cloak type="button" ng-click="dequeue(song)">
              Remove
            </p>

          </div>

        </div>

      </div>
      <!-- to display chat window -->
      <div id="chat" ng-controller="ChatController">
        <!-- tabs to display messages or users online -->
        <div ng-style="chatstyle" id="chat-tab" ng-click="changeTab('chat')">
          <strong>chat</strong>
        </div>

        <div ng-style="userstyle" id="users-tab" ng-click="changeTab('users')">
          <strong>users </strong><div id="users-connected">({{usersConnected}})</div>
        </div>

        <div id="chat-container" scroll-directive="messages" ng-model="messages">

          <table class="chat-table">

            <tbody ng-show="tab =='chat'" id="messages" ng-repeat="message in messages track by $index">

              <tr class="user-name">
                <!-- to display user name and time stamp of message -->
                <td ng-cloak id="user-name" ng-show="messages[{{$index-1}}].username !== message.username">

                  <strong>{{ message.username }}</strong> <span class="time">{{message.time}}</span>

                </td>

              </tr>

              <tr class="user-message">
                <!-- to display all messages -->
                <td id="user-message" ng-cloak ng-bind-html="message.message | linky:'_blank'">
                </td>

              </tr>

            </tbody>
            <!-- functionality to display chat messages or online users -->
            <tbody id="messages" ng-show="tab == 'users'">

              <tr ng-repeat="user in usernameList">

                <td ng-cloak id="user-list">

                  <strong>{{user}}</strong>

                </td>

              </tr>

            </tbody>

          </table>

        </div>
          <!-- to display area to type messages and submit -->
          <form id="chat-submit" ng-submit="send(message)">

            <input id="chat-input" ng-model="message" type="text" placeholder="Enter Message" autocomplete="off" required/>

          </form>
      </div>
    <!-- volume control script -->
    <script>
      $('input[type=range]').on('input', function(e){
        var min = e.target.min,
            max = e.target.max,
            val = e.target.value;

        $(e.target).css({
          'backgroundSize': (val - min) * 100 / (max - min) + '% 100%'
        });
      }).trigger('input');
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.0-rc.2/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular-sanitize.js"></script>
    <script src="chat.js"></script>
    <script src="search.js"></script>
    <script src="music.js"></script>
  </body>
</html>



